{
    "variables": {},
    "pipeline":
        [
            {
                "$project": {
                    "yearsFields": { "$objectToArray": "$years_in_web3" }
                }
            },
            {
                "$unwind": "$yearsFields"
            },
            {
                "$match": { "yearsFields.k": "$share" }
            },
            {
                "$group": {
                    "_id": null,
                    "total_years": { "$sum": "$yearsFields.v" },
                    "count": { "$sum": 1 }
                }
            },
            {
                "$project": {
                    "_id": 0,
                    "sum_years_in_web3": {
                        "%share": {
                            "$mod": [
                                "$total_years",
                                { "$add": [{ "$pow": [2, 32] }, 15] }
                            ]
                        }
                    },
                    "user_count": "$count"
                }
            }
        ]
    }